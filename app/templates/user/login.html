{% extends 'base.html' %}

{% block main %}
    <div class="sep20"></div>
    <div class="sep20"></div>
    <div class="panel panel-default">
    <form method="POST" class="form-horizontal form-custom" action="/login">
        <fieldset>
            <legend>Sign in</legend>
            <div class="form-group">
                {{ form.hidden_tag() }}
                {{ form.email.label(class='control-label col-lg-2') }}
                <div class="col-lg-10 {% if form.email.errors %} has-error {% endif %}">
                    {{ form.email(class='form-control', placeholder='Email or Username') }}
                </div>
                {% if form.email.errors %}
                    {% for error in form.email.errors %}
                        <div class="col-lg-10 col-lg-offset-2 text-danger "> {{ error }}</div>
                    {% endfor %}
                {% endif %}
            </div>
            <div class="form-group">
                {{ form.password.label(class='control-label col-lg-2') }}
                <div class="col-lg-10 {% if form.password.errors %} has-error {% endif %}">
                    {{ form.password(class='form-control', placeholder='Password') }}
                </div>
                {% if form.password.errors %}
                    {% for error in form.password.errors %}
                        <div class="col-lg-10 col-lg-offset-2 text-danger "> {{ error }}</div>
                    {% endfor %}
                {% endif %}
            </div>
            <div class="form-group">
                    {{ form.remeber_me.label(class='control-label col-lg-2') }}
                    <div class="col-lg-10">
                        {{ form.remeber_me(class='form-control') }}
                    </div>
                </div>
            <div class="form-group">
                <div id="embed-captcha"></div>
                <p id="wait" class="show">Loading verification code....</p>
                <p id="notice" class="hide">Please drag the code to the appropriate location</p>
            </div>
            <div class="form-group">
                <div class="col-lg-10 col-lg-offset-2">
                    {{ form.submit(class='btn btn-primary') }}
                    <div class="pull-right">No account？<a href="/login">Sign up</a>,<a href="/forget">forget password？</a> </div>
                </div>
            </div>
        </fieldset>
    </form>
    </div>
{% endblock %}

{% block scripts %}
    {{ super() }}
    <script>
    var handlerEmbed=function(captchaObj){$("#embed-submit").click(function(e){var validate=captchaObj.getValidate();if(!validate){$("#notice")[0].className="show";setTimeout(function(){$("#notice")[0].className="hide"},2000);e.preventDefault()}});captchaObj.appendTo("#embed-captcha");captchaObj.onReady(function(){$("#wait")[0].className="hide"})};$.ajax({url:"/register?t="+(new Date()).getTime(),type:"get",dataType:"json",success:function(data){initGeetest({gt:data.gt,challenge:data.challenge,product:"embed",offline:!data.success},handlerEmbed)}});
    </script>
{% endblock %}